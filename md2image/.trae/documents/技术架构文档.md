# AI Markdown å¯è§†åŒ–å›¾æ–‡ç”Ÿæˆå™¨ - æŠ€æœ¯æ¶æ„æ–‡æ¡£

## 1. æ¶æ„è®¾è®¡

```mermaid
graph TD
    A[ç”¨æˆ·æµè§ˆå™¨] --> B[Vue 3 å‰ç«¯åº”ç”¨]
    B --> C[FastAPI åç«¯æœåŠ¡]
    C --> D[OpenAI API]
    
    subgraph "å‰ç«¯å±‚"
        B
        E[CodeMirror 6 ç¼–è¾‘å™¨]
        F[Markdown-it è§£æå™¨]
        G[Html2canvas å›¾ç‰‡ç”Ÿæˆ]
        H[Swiper åˆ†é¡µç»„ä»¶]
    end
    
    subgraph "åç«¯å±‚"
        C
        I[AI å¤„ç†æ¨¡å—]
    end
    
    subgraph "å¤–éƒ¨æœåŠ¡"
        D
    end
    
    B --> E
    B --> F
    B --> G
    B --> H
    C --> I
    I --> D
```

## 2. æŠ€æœ¯æè¿°

* **å‰ç«¯**: Vue 3 (Composition API) + Vite + Tailwind CSS + TypeScript

* **åç«¯**: Python 3.10+ + FastAPI + OpenAI + httpx

* **ç¼–è¾‘å™¨**: CodeMirror 6

* **Markdownè§£æ**: markdown-it

* **å›¾ç‰‡ç”Ÿæˆ**: html2canvas

* **åˆ†é¡µç»„ä»¶**: Swiper.js

## 3. è·¯ç”±å®šä¹‰

| è·¯ç”±        | ç”¨é€”                         |
| --------- | -------------------------- |
| /         | ä¸»ç¼–è¾‘é¡µé¢ï¼ŒåŒ…å«Markdownç¼–è¾‘å™¨å’Œå®æ—¶é¢„è§ˆé¢æ¿ |
| /settings | è®¾ç½®é¡µé¢ï¼Œä¸»é¢˜åˆ‡æ¢å’Œå¯¼å‡ºé…ç½®             |

## 4. APIå®šä¹‰

### 4.1 æ ¸å¿ƒAPI

AIå¢å¼ºå¤„ç†æ¥å£

```
POST /api/v1/enhance
```

è¯·æ±‚å‚æ•°:

| å‚æ•°åç§°           | å‚æ•°ç±»å‹   | æ˜¯å¦å¿…éœ€  | æè¿°                                                 |
| -------------- | ------ | ----- | -------------------------------------------------- |
| markdown\_text | string | true  | åŸå§‹Markdownæ–‡æœ¬å†…å®¹                                     |
| task           | string | true  | å¤„ç†ä»»åŠ¡ç±»å‹ï¼šauto\_image, beautify\_table, segment\_text |
| style\_prompt  | string | false | å¯é€‰çš„é£æ ¼æç¤ºè¯                                           |

å“åº”å‚æ•°:

| å‚æ•°åç§°                     | å‚æ•°ç±»å‹   | æè¿°                  |
| ------------------------ | ------ | ------------------- |
| enhanced\_markdown\_text | string | AIå¢å¼ºåçš„Markdownæ–‡æœ¬    |
| status                   | string | å¤„ç†çŠ¶æ€ï¼šsuccess, error |
| message                  | string | é”™è¯¯ä¿¡æ¯æˆ–å¤„ç†è¯´æ˜           |

è¯·æ±‚ç¤ºä¾‹:

```json
{
  "markdown_text": "# æ ‡é¢˜\n\nè¿™æ˜¯ä¸€æ®µæ–‡æœ¬",
  "task": "auto_image",
  "style_prompt": "ä¸“ä¸šå•†åŠ¡é£æ ¼"
}
```

å“åº”ç¤ºä¾‹:

```json
{
  "enhanced_markdown_text": "# ğŸ¯ ä¸“ä¸šæ ‡é¢˜\n\nè¿™æ˜¯ä¸€æ®µç»è¿‡AIä¼˜åŒ–çš„ä¸“ä¸šæ–‡æœ¬å†…å®¹ï¼Œå…·æœ‰æ›´å¥½çš„å¯è¯»æ€§å’Œè§†è§‰æ•ˆæœã€‚",
  "status": "success",
  "message": "å†…å®¹å¢å¼ºå®Œæˆ"
}
```

## 5. æœåŠ¡ç«¯æ¶æ„å›¾

```mermaid
graph TD
    A[å®¢æˆ·ç«¯è¯·æ±‚] --> B[FastAPI è·¯ç”±å±‚]
    B --> C[ä¸šåŠ¡é€»è¾‘å±‚]
    C --> D[AI æœåŠ¡å±‚]
    D --> E[OpenAI API]
    
    subgraph "FastAPI æœåŠ¡ç«¯"
        B
        C
        D
        F[å¼‚å¸¸å¤„ç†ä¸­é—´ä»¶]
        G[CORS ä¸­é—´ä»¶]
    end
    
    B --> F
    B --> G
```

## 6. æ•°æ®æ¨¡å‹

### 6.1 æ•°æ®æ¨¡å‹å®šä¹‰

æœ¬é¡¹ç›®ä¸ºæ— çŠ¶æ€åº”ç”¨ï¼Œä¸éœ€è¦æŒä¹…åŒ–æ•°æ®åº“ã€‚æ‰€æœ‰æ•°æ®é€šè¿‡APIè¯·æ±‚ä¼ è¾“ã€‚

**æ ¸å¿ƒæ•°æ®ç»“æ„ï¼š**

```typescript
// Markdowné¡µé¢æ•°æ®
interface MarkdownPage {
  id: string;
  content: string;
  htmlContent: string;
}

// åº”ç”¨é…ç½®
interface AppConfig {
  theme: 'light' | 'dark';
  exportQuality: 1 | 2 | 3;
  fontSize: number;
  pageMargin: number;
}

// AIå¢å¼ºè¯·æ±‚
interface EnhanceRequest {
  markdown_text: string;
  task: 'auto_image' | 'beautify_table' | 'segment_text';
  style_prompt?: string;
}

// AIå¢å¼ºå“åº”
interface EnhanceResponse {
  enhanced_markdown_text: string;
  status: 'success' | 'error';
  message: string;
}
```

### 6.2 æ•°æ®æµç¨‹

**å®æ—¶é¢„è§ˆæµç¨‹ï¼š**

1. ç”¨æˆ·åœ¨CodeMirrorç¼–è¾‘å™¨ä¸­è¾“å…¥Markdownæ–‡æœ¬
2. å‰ç«¯ç›‘å¬å†…å®¹å˜åŒ–ï¼Œä½¿ç”¨"---"åˆ†å‰²ç¬¦åˆ†é¡µ
3. ä½¿ç”¨markdown-itå°†æ¯é¡µMarkdownè§£æä¸ºHTML
4. åº”ç”¨Tailwind CSSæ ·å¼æ¸²æŸ“åˆ°é¢„è§ˆé¢æ¿
5. æ›´æ–°Swiperåˆ†é¡µç»„ä»¶æ˜¾ç¤ºå¤šé¡µå†…å®¹

**AIå¢å¼ºæµç¨‹ï¼š**

1. ç”¨æˆ·ç‚¹å‡»AIå¢å¼ºæŒ‰é’®
2. å‰ç«¯æ”¶é›†å½“å‰Markdownå†…å®¹å’Œé…ç½®å‚æ•°
3. å‘é€POSTè¯·æ±‚åˆ°/api/v1/enhanceç«¯ç‚¹
4. åç«¯è°ƒç”¨OpenAI APIå¤„ç†å†…å®¹
5. è¿”å›å¢å¼ºåçš„Markdownæ–‡æœ¬
6. å‰ç«¯æ›´æ–°ç¼–è¾‘å™¨å†…å®¹ï¼Œè§¦å‘å®æ—¶é¢„è§ˆ

**å›¾ç‰‡ç”Ÿæˆæµç¨‹ï¼š**

1. ç”¨æˆ·é…ç½®å¯¼å‡ºå‚æ•°ï¼ˆä¸»é¢˜ã€æ¸…æ™°åº¦ï¼‰
2. ç‚¹å‡»ç”Ÿæˆå›¾ç‰‡æŒ‰é’®
3. å‰ç«¯ä½¿ç”¨html2canvasæ•è·å½“å‰é¢„è§ˆé¡µé¢
4. æ ¹æ®æ¸…æ™°åº¦è®¾ç½®scaleå‚æ•°
5. ç”ŸæˆCanvaså¹¶è½¬æ¢ä¸ºå›¾ç‰‡æ•°æ®
6. è§¦å‘æµè§ˆå™¨ä¸‹è½½å›¾ç‰‡æ–‡

